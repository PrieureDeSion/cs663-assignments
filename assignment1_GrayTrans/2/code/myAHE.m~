tic
windowsize = 50;
org = imread('../data/barbara.png');
[x, y, k] = size(org)
img = zeros(size(org));

for i = windowsize+1:x-windowsize
    for j = windowsize+1:y-windowsize
        mycdf = cumsum(imhist(org(i-windowsize:i+windowsize, j-windowsize:j+windowsize)))...
            / numel(org(i-windowsize:i+windowsize, j-windowsize:j+windowsize)); % numel fixed at 961
        img(i, j) = mycdf(org(i, j));
    end
    i
end
toc

clear all

tic
windowsize = 20;
org = imread('../data/barbara.png');
[x, y, k] = size(org)
img = zeros(size(org));

[]
img = arrayfun(@(pval)ahe_core(pval), )
